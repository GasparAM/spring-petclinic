huge changes to the code
aa looot of code