huge changes to the code
again